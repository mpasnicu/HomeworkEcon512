function f = func_P(old_V, old_P)


global L c beta


[D_0, D_1, D_2] = computeD(old_P, old_P');
[W_0, W_1, W_2] = computeW(old_V);

f = betta.*(D_0.*W_0 + D_1.*W_1 + D_2.*W_2) - betta*W_1 - (1-D_1).*(P1 - repmat(cost,1,L)) + 1;

end